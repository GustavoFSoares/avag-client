import{O as w,y as n,z as _,H as s,V as E,N as v,I as T,G as H,S as Q,U as P,f as p,$ as D,R as m,A,C as y,k as r,B as S,F as C,D as B,a0 as G,a1 as j,g as O,a2 as U,P as Y,r as x,o as J}from"./index.b3a0437d.js";import{A as K}from"./AvPage.b8bd41c2.js";import{A as W}from"./AvCard.2106c930.js";import{A as R}from"./AvReward.d9771408.js";/* empty css                                                             */const X={name:"AvProgressBar",props:{progress:{type:Number,default:0},inline:{type:Boolean,default:!1},height:{type:Number,default:3}},setup(){return{levelFormatter:c=>c.toLocaleString("pt-BR")}}},Z=e=>(Q("data-v-006fc0ec"),e=e(),P(),e),ee=Z(()=>s("div",{class:"av-progress-bar-progress"},null,-1)),te={class:"av-progress-bar-index"},se={class:"av-progress-bar-index__start"};function ae(e,c,t,l,a,d){return n(),_("div",{class:T(["av-progress-bar",{"av-progress-bar--inline":t.inline}]),style:H({"--bar-progress":`${t.progress}%`,"--bar-height":`${t.height}px`})},[ee,s("div",te,[E(e.$slots,"default",{},()=>[s("div",se,v(l.levelFormatter(t.progress))+"% ",1)],!0)])],6)}var q=w(X,[["render",ae],["__scopeId","data-v-006fc0ec"]]);const N=0,oe={name:"StageItem",props:{position:{type:[String,Number],required:!0},rank:{type:Number,required:!0},active:{type:Boolean,required:!0},completed:{type:Boolean,required:!0}},setup(e){const c=p(()=>D.xs),t=p(()=>100*e.rank/N),l=p(()=>Number(e.position)+1);return{TOTAL_STARS:N,isMobile:c,itemProgress:t,positionLabel:l}}},ne=e=>(Q("data-v-06388401"),e=e(),P(),e),ie={class:"stage-item__container"},le={class:"stage-item__content"},ce={class:"stage-item__position"},re=ne(()=>s("div",{class:"stage-item__badgse"},null,-1));function _e(e,c,t,l,a,d){const o=m("QIcon"),i=m("QBadge");return n(),_("li",{class:T(["stage-item",{"stage-item--completed":t.completed,"stage-item--blocked":!t.active}])},[t.completed?(n(),A(i,{key:0,class:"stage-item__completed-flag",color:"green-9"},{default:y(()=>[r(o,{name:"check",rounded:"",color:"white",size:"xs"})]),_:1})):S("",!0),S("",!0),s("div",ie,[s("div",le,[s("div",ce,v(l.positionLabel),1),re])])],2)}var de=w(oe,[["render",_e],["__scopeId","data-v-06388401"]]);const ue={name:"StageList",emits:["open-stage"],components:{StageItem:de},props:{stages:{type:Array,required:!0}},setup(e,c){const t=p(()=>D.xs),l=p(()=>e.stages),a=({active:o,position:i})=>{!o||c.emit("open-stage",i)},d=p(()=>{const o=[...e.stages],i=[];for(;o.length!==0;){const u=o.splice(0,t.value?1:5);i.push(u)}return i});return{isMobile:t,stageList:l,preparedList:d,handleClickStage:a}}},ge={class:"stage-list"};function pe(e,c,t,l,a,d){const o=m("StageItem");return n(),_("div",ge,[(n(!0),_(C,null,B(l.preparedList,(i,u)=>(n(),_("ol",{class:"stage-list__list-column",key:u},[(n(!0),_(C,null,B(i,(g,b)=>(n(),A(o,{class:"stage-list__item",key:g.id,active:g.active,position:u*5+b,rank:g.rank,completed:g.completed,onClick:I=>l.handleClickStage(g)},null,8,["active","position","rank","completed","onClick"]))),128))]))),128))])}var ve=w(ue,[["render",pe],["__scopeId","data-v-60d900ca"]]);const me={class:"stage-list-detail__content"},he={class:"stage-list-detail__position"},ye={class:"stage-list-detail__title"};const Se={key:1,class:"stage-list-detail__types"};const fe="modules.activities.pages.stageList.detail",ke="modules.activities.stageType",$e={__name:"Detail",props:{stage:{type:Object,default:()=>({progress:0})}},emits:["close"],setup(e,{emit:c}){const t=e,{appContext:l}=O(),a=p(()=>t.stage.types?t.stage.types.map(u=>({icon:l.config.globalProperties.$iconsMap[u]||u,name:u})):null),d=p(()=>Number(t.stage.position)+1),o=()=>{ctx.emit("close")};return(i,u)=>{const g=m("QBtn"),b=m("QIcon"),I=m("QTooltip");return n(),A(j,{class:"stage-list-detail"},{default:y(()=>[s("div",me,[r(g,{class:"stage-list-detail__close",icon:"close",flat:"",rounded:"",padding:"sm",onClick:o}),s("div",he,v(d.value),1),s("h1",ye,v(e.stage.name),1),S("",!0),a.value?(n(),_("div",Se,[(n(!0),_(C,null,B(a.value,f=>(n(),_("div",{class:"stage-list-detail__type",key:f},[r(I,null,{default:y(()=>[G(v(i.$t(`${ke}.${f.name}`)),1)]),_:2},1024),r(b,{class:"stage-list-detail__type-icon",name:f.icon},null,8,["name"])]))),128))])):S("",!0),r(q,{class:"stage-list-detail__progress-bar",progress:e.stage.progress},null,8,["progress"]),e.stage.reward?(n(),A(R,{key:2,class:"stage-list-detail__rewards",points:e.stage.reward.points,coins:e.stage.reward.coins,column:""},null,8,["points","coins"])):S("",!0),r(g,{class:"stage-list-detail__start-activity",label:i.$t(`${fe}.startActivity`),color:"primary",to:{name:"activities.stage",params:{id:e.stage.trailId,stageId:e.stage.id}}},null,8,["label","to"])])]),_:1})}}};var be=w($e,[["__scopeId","data-v-e6a8388c"]]);const F=e=>(Q("data-v-388e4a12"),e=e(),P(),e),Ie={class:"stage-list-header"},Ae={key:0,class:"app-container__content"},we={class:"stage-description__card"},xe={key:0,class:"stage-description__image-wrapper"},Ce=["src","alt"],Le=["title"],Be={class:"stage-description__tasks-count"},Te={key:1,class:"app-container__content"},Qe={class:"goal-content"},Pe=F(()=>s("h1",{class:"goal-content__title"},"Objetivo",-1)),Ne={class:"goal-content__description"},De={class:"goal-control"},Oe=F(()=>s("span",{class:"goal-control__button-text"},"Continuar",-1)),Re={__name:"StageListPage",setup(e){const c=U(),t=Y(),{appContext:l}=O(),a=x({}),d=x([]),o=x(null),i=x(c.query.goal),u=h=>{const k=o.value;o.value=null,k?setTimeout(()=>{o.value=h},350):o.value=h},g=p(()=>!!o.value),b=p(()=>d.value.find(k=>k.position===o.value)||{}),I=()=>{o.value=null},f=()=>{i.value=!1};return J(async()=>{const{name:h,description:k,goal:L,cover:$,activities:M,progress:V,reward:z}=await t.dispatch("ActivitiesModule/getActivityById",c.params.id);a.value={title:h,description:k,goal:L,progress:V,reward:z,cover:{url:$!=null&&$.path?`${l.config.globalProperties.$appStorage}/${$.path}`:l.config.globalProperties.$defaultActivityCover,description:h}},d.value=M,t.dispatch("ActivitiesModule/startActivity",c.params.id)}),(h,k)=>{const L=m("QIcon"),$=m("QDialog");return n(),_(C,null,[r(K,{class:T(["stage-list-page",{"stage-list-page--showing-goal":i.value}]),title:a.value.title,"go-back-route":{name:"home.activities"},"header-background":"white","column-header":""},{header:y(()=>[s("div",Ie,[r(q,{class:"stage-list-header__progress-bar",progress:a.value.progress,inline:""},null,8,["progress"]),a.value.reward?(n(),A(R,{key:0,class:"stage-list-header__reward",coins:a.value.reward.coins,points:a.value.reward.points},null,8,["coins","points"])):S("",!0)])]),default:y(()=>[i.value?(n(),_("div",Te,[s("div",Qe,[Pe,s("h2",Ne,v(a.value.goal),1),s("div",De,[s("button",{class:"goal-control__button",onClick:f},[r(L,{class:"goal-control__button-icon",name:"expand_less"}),Oe])])])])):(n(),_("div",Ae,[r(W,{class:"stage-description"},{default:y(()=>[s("div",we,[a.value.cover?(n(),_("div",xe,[s("img",{class:"stage-description__image",src:a.value.cover.url,alt:a.value.cover.description},null,8,Ce)])):S("",!0),s("h2",{class:"stage-description__text",title:a.value.description},v(a.value.description),9,Le),s("h6",Be,v(d.value.length)+" atividades ",1)])]),_:1}),r(ve,{stages:d.value,onOpenStage:u},null,8,["stages"])]))]),_:1},8,["class","title","go-back-route"]),r($,{"model-value":g.value,position:"right","full-height":"",onHide:I},{default:y(()=>[r(be,{stage:b.value,onClose:I},null,8,["stage"])]),_:1},8,["model-value"])],64)}}};var Ee=w(Re,[["__scopeId","data-v-388e4a12"]]);export{Ee as default};
